# Транзакции / Transaction

**Транзакция** - это набор запросов в БД объединенных в одну пачку.
```SQL
BEGIN TRANSACTION
<some sql actions>
COMMIT / ROLLBACK
END
```

### Проблемы параллельных транзакций
Есть список проблем с параллельным запуском транзакций:
- Потерянное обновление - при обновлении одной и той же записи одновременно двумя или более транзакциями может случиться так что первое изменение применится но потеряется т.к. второе изменение выполнится позже. При этом оба изменение будут учитывать исходные данные не зная об изменениях друг друга
- "Грязное" чтение - чтение данных которые не успели "откатиться" (rollback) или "закоммититься" (commit)
- Неповторяющееся чтение - одно и то же чтение (select) в рамках одной (!) транзакции может принести разные результаты т.к. параллельно была выполнена модификация этой записи
- Чтение "фантомов" - почти то же самое что и "неповторяющееся чтение" но относится не к update а к insert, то есть добавлению новых записей

### Уровни изоляции
Вышеуказанные проблемы решаются уровнями изоляций
- Read uncommitted - отсутствие изоляции, транзакции могут читать данные которые были произведены другими транзакциями и при этом не закоммитилсь или не откатились
- Read committed - чтение только закомиченных (или откатанных) данных
- Repeatable read - ожидание пока не закончится изменение данных предыдущей транзакцией (которые касаются выбранной таблицы и столбцов)
- Serializable - полная блокировка всего чтения во время изменений